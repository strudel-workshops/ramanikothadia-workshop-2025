import{K as x,j as n,P as y,S as f,B as v,v as h,N as g}from"./index-BwI74Y1v.js";import{C as j}from"./Close-_Ou4gZrC.js";import{u as A,h as B}from"./FilterField-HJQCpZR3.js";import{C}from"./DataGrid-BIuPBIwQ.js";import{I as b}from"./IconButton-CtsuKVV5.js";const I=({header:a="Filters",grouped:s=!0,onChange:l,onClose:c,config:d,children:i,...o})=>{const{activeFilters:e,dispatch:t}=A();let r=0;x.Children.forEach(i,p=>{if(x.isValidElement(p)&&p.props.field&&B(e.find(m=>m.field===p.props.field)))return r++});const u=()=>{t({type:"SET_ACTIVE_FILTERS",payload:[]})};return n.jsx(y,{elevation:0,variant:"outlined",...o,children:n.jsxs(f,{spacing:0,children:[a&&n.jsxs(f,{direction:"row",spacing:0,alignItems:"center",sx:{borderBottom:"1px solid",borderBottomColor:"grey.300",paddingLeft:2,paddingRight:2,paddingTop:1,paddingBottom:1},children:[n.jsxs(f,{direction:"row",spacing:2,flex:1,children:[n.jsx(v,{children:a}),r>0&&n.jsx(C,{label:`${r} active`,color:"primary",size:"small"})]}),n.jsx(h,{variant:"outlined",onClick:u,sx:{marginRight:1},children:"Reset"}),n.jsx(b,{onClick:c,children:n.jsx(j,{})})]}),s&&n.jsx(f,{spacing:0,children:i}),!s&&n.jsx(f,{spacing:2,sx:{padding:2},children:i})]})})},E=(a,s)=>{let l=a;return s&&(l=a.filter(c=>JSON.stringify(c).toLowerCase().indexOf(s.toLowerCase())>-1)),l},w=(a,s,l)=>{let c=a;if(a&&s.length>0){const d={};s.forEach(i=>{if(l){const o=l.find(e=>e.field===i.field);d[i.field]=o==null?void 0:o.operator}}),c=a.filter(i=>{let o=!0;return s.forEach(e=>{let t=!1;if(o===!0)switch(d[e.field]){case"contains":{i[e.field].indexOf(e.value)>-1&&(t=!0);break}case"contains-one-of":{Array.isArray(e.value)&&e.value.forEach(r=>{t||(Array.isArray(i[e.field])?i[e.field].indexOf(r)>-1&&(t=!0):i[e.field]===r&&(t=!0))});break}case"equals-one-of":{Array.isArray(e.value)&&e.value.forEach(r=>{t||i[e.field]===r&&(t=!0)});break}case"between-inclusive":{if(Array.isArray(e.value)){const r=e.value[0],u=e.value[1];i[e.field]>=r&&i[e.field]<=u&&(t=!0)}break}case"between-dates-inclusive":{if(typeof i[e.field]=="string"&&Array.isArray(e.value)&&e.value[0]&&e.value[1]){const r=g(i[e.field]);r.isAfter(e.value[0])&&r.isBefore(e.value[1])&&(t=!0)}else t=!0;break}}t||(o=!1)}),o})}return c},O=(a,s,l,c)=>{const d=E(a,c);return w(d,s,l)};export{I as F,O as f};
