import{K as x,j as o,P as g,S as u,B as y,v as m,N as h}from"./index-DNw4fbmd.js";import{C as j}from"./Close-COkHL3f4.js";import{u as A,h as B}from"./FilterField-DC_Xfzso.js";import{C as b}from"./DataGrid-ClocBCB3.js";import{I as w}from"./IconButton-CdJ2IDGe.js";const O=({header:t="Filters",grouped:s=!0,onChange:d,onClose:l,config:c,children:i,...n})=>{const{activeFilters:e,dispatch:r}=A();let a=0;x.Children.forEach(i,p=>{if(x.isValidElement(p)&&p.props.field&&B(e.find(v=>v.field===p.props.field)))return a++});const f=()=>{r({type:"SET_ACTIVE_FILTERS",payload:[]})};return o.jsx(g,{elevation:0,variant:"outlined",...n,children:o.jsxs(u,{spacing:0,children:[t&&o.jsxs(u,{direction:"row",spacing:0,alignItems:"center",sx:{borderBottom:"1px solid",borderBottomColor:"grey.300",paddingLeft:2,paddingRight:2,paddingTop:1,paddingBottom:1},children:[o.jsxs(u,{direction:"row",spacing:2,flex:1,children:[o.jsx(y,{children:t}),a>0&&o.jsx(b,{label:`${a} active`,color:"primary",size:"small"})]}),o.jsx(m,{variant:"outlined",onClick:f,sx:{marginRight:1},children:"Reset"}),o.jsx(w,{onClick:l,children:o.jsx(j,{})})]}),s&&o.jsx(u,{spacing:0,children:i}),!s&&o.jsx(u,{spacing:2,sx:{padding:2},children:i})]})})},C=(t,s,d="text")=>{let l=t;if(s)if(d==="regex")try{const c=new RegExp(s,"i");l=t.filter(i=>{const n=JSON.stringify(i);return c.test(n)})}catch{return t}else l=t.filter(c=>JSON.stringify(c).toLowerCase().indexOf(s.toLowerCase())>-1);return l},E=(t,s,d)=>{let l=t;if(t&&s.length>0){const c={};s.forEach(i=>{if(d){const n=d.find(e=>e.field===i.field);c[i.field]=n==null?void 0:n.operator}}),l=t.filter(i=>{let n=!0;return s.forEach(e=>{let r=!1;if(n===!0)switch(c[e.field]){case"equals":{e.field==="status"?e.value==="active"?i[e.field]!=="done"&&(r=!0):e.value==="done"&&i[e.field]==="done"&&(r=!0):i[e.field]===e.value&&(r=!0);break}case"contains":{i[e.field].indexOf(e.value)>-1&&(r=!0);break}case"contains-one-of":{Array.isArray(e.value)&&e.value.forEach(a=>{r||(Array.isArray(i[e.field])?i[e.field].indexOf(a)>-1&&(r=!0):i[e.field]===a&&(r=!0))});break}case"equals-one-of":{Array.isArray(e.value)&&e.value.forEach(a=>{r||i[e.field]===a&&(r=!0)});break}case"between-inclusive":{if(Array.isArray(e.value)){const a=e.value[0],f=e.value[1];i[e.field]>=a&&i[e.field]<=f&&(r=!0)}break}case"between-dates-inclusive":{if(typeof i[e.field]=="string"&&Array.isArray(e.value)&&e.value[0]&&e.value[1]){const a=h(i[e.field]);a.isAfter(e.value[0])&&a.isBefore(e.value[1])&&(r=!0)}else r=!0;break}}r||(n=!1)}),n})}return l},T=(t,s,d,l,c="text")=>{const i=C(t,l,c);return E(i,s,d)};export{O as F,T as f};
